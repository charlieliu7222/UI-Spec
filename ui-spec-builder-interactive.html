<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI Spec Builder Pro - å®Œæ•´ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 20px;
        }
        
        .panel {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
            color: #1f2937;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        h2 {
            font-size: 16px;
            margin: 20px 0 12px 0;
            color: #374151;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 6px;
            color: #4b5563;
        }
        
        input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }
        
        textarea {
            width: 100%;
            font-family: 'Courier New', monospace;
            min-height: 400px;
            resize: vertical;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 13px;
            line-height: 1.6;
        }
        
        button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 8px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            margin-right: 6px;
            margin-bottom: 6px;
            transition: background 0.2s;
        }
        
        button:hover {
            background: #1d4ed8;
        }
        
        button.secondary {
            background: #6b7280;
        }
        
        button.secondary:hover {
            background: #4b5563;
        }
        
        button.small {
            padding: 5px 10px;
            font-size: 12px;
        }
        
        /* çµ„ä»¶åˆ†é¡ */
        .component-category {
            margin-bottom: 16px;
            padding: 14px;
            background: #f9fafb;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .category-title {
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .component-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        
        .component-buttons button {
            margin: 0;
        }
        
        .output-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 16px;
            border-bottom: 2px solid #e5e7eb;
            overflow-x: auto;
        }
        
        .output-tabs button {
            background: transparent;
            color: #6b7280;
            border: none;
            border-bottom: 2px solid transparent;
            margin: 0 0 -2px 0;
            padding: 10px 16px;
            border-radius: 0;
            font-size: 14px;
            white-space: nowrap;
        }
        
        .output-tabs button.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
            font-weight: 600;
        }
        
        .output-content {
            display: none;
        }
        
        .output-content.active {
            display: block;
        }
        
        pre {
            background: #1f2937;
            color: #f3f4f6;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.5;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .action-buttons {
            margin-bottom: 12px;
            display: flex;
            gap: 8px;
        }
        
        .help-text {
            font-size: 12px;
            color: #6b7280;
            margin-top: 6px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .quick-examples {
            background: #f0f9ff;
            padding: 12px;
            border-radius: 6px;
            margin-top: 16px;
            border: 1px solid #bfdbfe;
        }
        
        .quick-examples h3 {
            font-size: 14px;
            margin-bottom: 8px;
            color: #1e40af;
        }
        
        .scrollable {
            max-height: 70vh;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        /* æ»¾å‹•æ¢æ¨£å¼ */
        .scrollable::-webkit-scrollbar {
            width: 8px;
        }
        
        .scrollable::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .scrollable::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        .scrollable::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .badge {
            display: inline-block;
            padding: 2px 8px;
            background: #10b981;
            color: white;
            font-size: 11px;
            border-radius: 12px;
            margin-left: 6px;
            font-weight: 500;
        }

        /* äº’å‹•åŠŸèƒ½é¢æ¿æ¨£å¼ */
        .interaction-panel {
            background: #f0f9ff;
            border: 2px solid #3b82f6;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .interaction-title {
            font-size: 14px;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .interaction-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .interaction-btn {
            padding: 8px 12px;
            background: white;
            border: 1px solid #bfdbfe;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            text-align: left;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .interaction-btn:hover {
            background: #dbeafe;
            border-color: #3b82f6;
            transform: translateY(-1px);
        }

        .interaction-btn.selected {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .interaction-icon {
            font-size: 16px;
        }

        .selection-info {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 12px;
            font-size: 13px;
            color: #92400e;
        }

        .selection-info.hidden {
            display: none;
        }

        .quick-actions {
            display: flex;
            gap: 6px;
            margin-top: 12px;
        }

        .quick-actions button {
            flex: 1;
            padding: 8px;
            font-size: 12px;
        }

        /* åŠŸèƒ½æ¨™ç±¤æ¨£å¼ */
        .function-tag {
            display: inline-block;
            padding: 2px 8px;
            background: #dbeafe;
            color: #1e40af;
            border-radius: 4px;
            font-size: 11px;
            margin-left: 4px;
            font-family: 'Courier New', monospace;
        }

        .stats {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 13px;
            color: #6b7280;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .copy-success {
            background: #10b981 !important;
        }

        /* è¦–è¦ºåŒ–å°ˆç”¨æ¨£å¼ - ASCII ç‰ˆæœ¬ */
        .visual-container {
            width: 100%;
            min-height: 500px;
            background: #1f2937;
            padding: 24px;
            border-radius: 8px;
            border: 2px solid #374151;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #f3f4f6;
            white-space: pre;
            overflow-x: auto;
            resize: vertical;
        }
        
        .visual-container:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .visual-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .visual-row {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            gap: 16px;
        }

        .visual-box {
            flex: 1;
            min-height: 60px;
            border: 2px solid #2563eb;
            border-radius: 6px;
            padding: 12px;
            background: #f9fafb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #1f2937;
            font-family: 'Courier New', monospace;
        }

        .visual-box.nested {
            min-height: 100px;
            flex-direction: column;
            align-items: flex-start;
            justify-content: flex-start;
            gap: 8px;
        }

        .visual-nested-item {
            background: white;
            border: 1px solid #d1d5db;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 13px;
        }

        .visual-arrow {
            color: #2563eb;
            font-size: 18px;
            font-weight: bold;
        }

        .visual-description {
            flex: 0 0 200px;
            font-size: 13px;
            color: #6b7280;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Left Panel: Component Selector -->
        <div class="panel">
            <h1>ğŸ¨ UI Spec Builder <span class="badge">Pro</span></h1>
            
            <div class="form-group">
                <label>é é¢åç¨±</label>
                <input type="text" id="pageName" value="æˆ‘çš„ç¬¬ä¸€æ¬¡" placeholder="ä¾‹å¦‚ï¼šä½¿ç”¨è€…ç®¡ç†é é¢">
            </div>
            
            <h2>ğŸ“¦ é¸æ“‡çµ„ä»¶</h2>
            <div class="help-text">ğŸ’¡ é»æ“Šä¸‹æ–¹æŒ‰éˆ•æ·»åŠ çµ„ä»¶åˆ°å³å´çµæ§‹</div>
            
            <!-- äº’å‹•åŠŸèƒ½é¢æ¿ -->
            <div class="interaction-panel">
                <div class="interaction-title">
                    âš¡ äº’å‹•åŠŸèƒ½
                </div>
                <div class="selection-info hidden" id="selectionInfo">
                    ğŸ“ æœªé¸æ“‡ä»»ä½•è¡Œ
                </div>
                <div class="interaction-grid">
                    <button class="interaction-btn" onclick="addInteraction('onClick')">
                        <span class="interaction-icon">ğŸ‘†</span>
                        <span>onClick</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onChange')">
                        <span class="interaction-icon">ğŸ”„</span>
                        <span>onChange</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onSubmit')">
                        <span class="interaction-icon">ğŸ“¤</span>
                        <span>onSubmit</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onHover')">
                        <span class="interaction-icon">ğŸ‘‹</span>
                        <span>onHover</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onFocus')">
                        <span class="interaction-icon">ğŸ¯</span>
                        <span>onFocus</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onBlur')">
                        <span class="interaction-icon">ğŸ‘ï¸</span>
                        <span>onBlur</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onKeyPress')">
                        <span class="interaction-icon">âŒ¨ï¸</span>
                        <span>onKeyPress</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onScroll')">
                        <span class="interaction-icon">ğŸ“œ</span>
                        <span>onScroll</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onLoad')">
                        <span class="interaction-icon">â³</span>
                        <span>onLoad</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onError')">
                        <span class="interaction-icon">âš ï¸</span>
                        <span>onError</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onResize')">
                        <span class="interaction-icon">â†”ï¸</span>
                        <span>onResize</span>
                    </button>
                    <button class="interaction-btn" onclick="addInteraction('onDrag')">
                        <span class="interaction-icon">ğŸ–±ï¸</span>
                        <span>onDrag</span>
                    </button>
                </div>
                <div class="quick-actions">
                    <button class="secondary small" onclick="removeInteractions()">ğŸ—‘ï¸ æ¸…é™¤åŠŸèƒ½</button>
                    <button class="small" onclick="highlightSelection()">ğŸ“ å®šä½é¸æ“‡</button>
                </div>
                <div class="help-text" style="margin-top: 8px;">
                    ğŸ’¡ åœ¨å³å´çµæ§‹ä¸­é»æ“Šæˆ–é¸ä¸­æ–‡å­—ï¼Œç„¶å¾Œé»æ“Šä¸Šæ–¹æŒ‰éˆ•æ·»åŠ åŠŸèƒ½
                </div>
            </div>
            
            <div class="scrollable">
                <!-- ä½ˆå±€å®¹å™¨ -->
                <div class="component-category">
                    <div class="category-title">ğŸ“ ä½ˆå±€å®¹å™¨</div>
                    <div class="component-buttons">
                        <button class="small" onclick="addComponent('Header')">Header</button>
                        <button class="small" onclick="addComponent('Toolbar')">Toolbar</button>
                        <button class="small" onclick="addComponent('Sidebar')">Sidebar</button>
                        <button class="small" onclick="addComponent('Content')">Content</button>
                        <button class="small" onclick="addComponent('Footer')">Footer</button>
                        <button class="small" onclick="addComponent('Container')">Container</button>
                        <button class="small" onclick="addComponent('Grid')">Grid</button>
                        <button class="small" onclick="addComponent('Flex')">Flex</button>
                    </div>
                </div>

                <!-- åŸºç¤çµ„ä»¶ -->
                <div class="component-category">
                    <div class="category-title">ğŸ”˜ åŸºç¤çµ„ä»¶</div>
                    <div class="component-buttons">
                        <button class="small" onclick="addComponent('Button')">Button</button>
                        <button class="small" onclick="addComponent('Input')">Input</button>
                        <button class="small" onclick="addComponent('Textarea')">Textarea</button>
                        <button class="small" onclick="addComponent('Select')">Select</button>
                        <button class="small" onclick="addComponent('Checkbox')">Checkbox</button>
                        <button class="small" onclick="addComponent('Radio')">Radio</button>
                        <button class="small" onclick="addComponent('Switch')">Switch</button>
                        <button class="small" onclick="addComponent('Slider')">Slider</button>
                    </div>
                </div>

                <!-- å°èˆªçµ„ä»¶ -->
                <div class="component-category">
                    <div class="category-title">ğŸ§­ å°èˆªçµ„ä»¶</div>
                    <div class="component-buttons">
                        <button class="small" onclick="addComponent('Navbar')">Navbar</button>
                        <button class="small" onclick="addComponent('Menu')">Menu</button>
                        <button class="small" onclick="addComponent('Tabs')">Tabs</button>
                        <button class="small" onclick="addComponent('Breadcrumb')">Breadcrumb</button>
                        <button class="small" onclick="addComponent('Pagination')">Pagination</button>
                        <button class="small" onclick="addComponent('Stepper')">Stepper</button>
                    </div>
                </div>

                <!-- æ•¸æ“šå±•ç¤º -->
                <div class="component-category">
                    <div class="category-title">ğŸ“Š æ•¸æ“šå±•ç¤º</div>
                    <div class="component-buttons">
                        <button class="small" onclick="addComponent('Table')">Table</button>
                        <button class="small" onclick="addComponent('List')">List</button>
                        <button class="small" onclick="addComponent('Card')">Card</button>
                        <button class="small" onclick="addComponent('Avatar')">Avatar</button>
                        <button class="small" onclick="addComponent('Badge')">Badge</button>
                        <button class="small" onclick="addComponent('Chip')">Chip</button>
                        <button class="small" onclick="addComponent('Tag')">Tag</button>
                        <button class="small" onclick="addComponent('Timeline')">Timeline</button>
                    </div>
                </div>

                <!-- åé¥‹çµ„ä»¶ -->
                <div class="component-category">
                    <div class="category-title">ğŸ’¬ åé¥‹çµ„ä»¶</div>
                    <div class="component-buttons">
                        <button class="small" onclick="addComponent('Alert')">Alert</button>
                        <button class="small" onclick="addComponent('Toast')">Toast</button>
                        <button class="small" onclick="addComponent('Modal')">Modal</button>
                        <button class="small" onclick="addComponent('Drawer')">Drawer</button>
                        <button class="small" onclick="addComponent('Tooltip')">Tooltip</button>
                        <button class="small" onclick="addComponent('Popover')">Popover</button>
                        <button class="small" onclick="addComponent('Progress')">Progress</button>
                        <button class="small" onclick="addComponent('Spinner')">Spinner</button>
                        <button class="small" onclick="addComponent('Skeleton')">Skeleton</button>
                    </div>
                </div>

                <!-- å…¶ä»–çµ„ä»¶ -->
                <div class="component-category">
                    <div class="category-title">ğŸ¯ å…¶ä»–çµ„ä»¶</div>
                    <div class="component-buttons">
                        <button class="small" onclick="addComponent('Dropdown')">Dropdown</button>
                        <button class="small" onclick="addComponent('Accordion')">Accordion</button>
                        <button class="small" onclick="addComponent('Carousel')">Carousel</button>
                        <button class="small" onclick="addComponent('Divider')">Divider</button>
                        <button class="small" onclick="addComponent('Icon')">Icon</button>
                        <button class="small" onclick="addComponent('Image')">Image</button>
                        <button class="small" onclick="addComponent('Video')">Video</button>
                        <button class="small" onclick="addComponent('Form')">Form</button>
                    </div>
                </div>
            </div>
            
            <div class="quick-examples">
                <h3>ğŸ“ å¿«é€Ÿç¯„ä¾‹</h3>
                <button class="small" onclick="loadExample('login')">ç™»å…¥é é¢</button>
                <button class="small" onclick="loadExample('dashboard')">å„€è¡¨æ¿</button>
                <button class="small" onclick="loadExample('form')">è¡¨å–®é é¢</button>
                <button class="small" onclick="loadExample('ecommerce')">é›»å•†é é¢</button>
                <button class="small" onclick="loadExample('admin')">å¾Œå°ç³»çµ±</button>
            </div>
        </div>
        
        <!-- Right Panel: Structure & Output -->
        <div class="panel">
            <h1>ğŸ“‹ çµæ§‹ & è¼¸å‡º</h1>
            
            <div class="output-tabs">
                <button class="active" onclick="switchTab('structure')">âœï¸ ç›®å‰çµæ§‹</button>
                <button onclick="switchTab('visual')">ğŸ¨ è¦–è¦ºåŒ–</button>
                <button onclick="switchTab('ascii')">ğŸ“ ASCII</button>
                <button onclick="switchTab('spec')">ğŸ¤– AIè¦æ ¼</button>
                <button onclick="switchTab('json')">{ } JSON</button>
                <button onclick="switchTab('gherkin')">ğŸ¥’ Gherkin</button>
            </div>
            
            <!-- ç›®å‰çµæ§‹ -->
            <div id="structure-output" class="output-content active">
                <div class="stats">
                    <div class="stat-item">
                        <span>ğŸ“Š</span>
                        <span id="line-count">0 è¡Œ</span>
                    </div>
                    <div class="stat-item">
                        <span>ğŸ¯</span>
                        <span id="component-count">0 çµ„ä»¶</span>
                    </div>
                </div>
                <div class="action-buttons">
                    <button onclick="generateSpec()">ğŸš€ ç”¢ç”Ÿè¦æ ¼</button>
                    <button class="secondary" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©º</button>
                    <button class="secondary" onclick="undo()">â†¶ å¾©åŸ</button>
                </div>
                <textarea id="structure" placeholder="é»æ“Šå·¦å´æŒ‰éˆ•æ·»åŠ çµ„ä»¶...&#10;&#10;æˆ–ç›´æ¥åœ¨é€™è£¡ç·¨è¼¯çµæ§‹ï¼š&#10;â”œâ”€ Header&#10;  â”œâ”€ Button: &quot;æŒ‰éˆ•&quot; (primary)&#10;â”œâ”€ Content&#10;  â”œâ”€ Card">â”œâ”€ Header (å›ºå®šåœ¨é ‚éƒ¨)
â”œâ”€ Toolbar (æ“ä½œå€)
â”œâ”€ Toggle Switch: "å•Ÿç”¨åŠŸèƒ½"
â”œâ”€ Checkbox: "åŒæ„æ¢æ¬¾"
â”œâ”€ Container (max-width: 1200px)
â”œâ”€ Flex Container (justify: space-between, align: center)
â”œâ”€ Content (ä¸»è¦å…§å®¹)
â”œâ”€ Content (ä¸»è¦å…§å®¹)
â”œâ”€ Content (ä¸»è¦å…§å®¹)
â”œâ”€ Content (ä¸»è¦å…§å®¹)
â”œâ”€ Content (ä¸»è¦å…§å®¹)
â”œâ”€ Content (ä¸»è¦å…§å®¹)
â”œâ”€ Drawer (position: right, width: 400px)
â”œâ”€ Modal Dialog (title: "æ¨™é¡Œ", width: 500px)
â”œâ”€ Tooltip: "æç¤ºæ–‡å­—"</textarea>
                <div class="help-text">ğŸ’¡ æç¤ºï¼šä½ ä¹Ÿå¯ä»¥ç›´æ¥ç·¨è¼¯é€™è£¡çš„å…§å®¹</div>
            </div>

            <!-- é é¢çµæ§‹è¦–è¦ºåŒ– -->
            <div id="visual-output" class="output-content">
                <div class="action-buttons">
                    <button onclick="copyOutput('visual')">ğŸ“‹ è¤‡è£½</button>
                    <button onclick="syncFromVisual()">â¬…ï¸ åŒæ­¥åˆ°çµæ§‹</button>
                    <button onclick="exportVisualASCII()">ğŸ’¾ åŒ¯å‡º</button>
                    <button onclick="refreshVisual()">ğŸ”„ é‡æ–°ç”Ÿæˆ</button>
                </div>
                <textarea id="visual-container" class="visual-container" spellcheck="false" placeholder="é»æ“Šã€Œç”¢ç”Ÿè¦æ ¼ã€æŒ‰éˆ•ç”Ÿæˆ ASCII è¦–è¦ºåœ–ï¼Œç„¶å¾Œä½ å¯ä»¥ç›´æ¥ç·¨è¼¯..."></textarea>
                <div class="help-text">
                    ğŸ’¡ æç¤ºï¼šå¯ç›´æ¥ç·¨è¼¯ ASCII åœ–ï¼Œä½¿ç”¨ â•”â•â•—â•‘â•šâ• â”Œâ”€â”â”‚â””â”˜ ç­‰å­—ç¬¦ç¹ªè£½ã€‚ç·¨è¼¯å¾Œé»æ“Šã€ŒåŒæ­¥åˆ°çµæ§‹ã€æ›´æ–°å·¦å´è¼¸å…¥ã€‚
                </div>
            </div>
            
            <!-- ASCII åœ– -->
            <div id="ascii-output" class="output-content">
                <div class="action-buttons">
                    <button onclick="copyOutput('ascii')">ğŸ“‹ è¤‡è£½</button>
                </div>
                <pre id="ascii-pre">é»æ“Šã€Œç”¢ç”Ÿè¦æ ¼ã€æŒ‰éˆ•æŸ¥çœ‹çµæœ...</pre>
            </div>
            
            <!-- AI è¦æ ¼ -->
            <div id="spec-output" class="output-content">
                <div class="action-buttons">
                    <button onclick="copyOutput('spec')">ğŸ“‹ è¤‡è£½</button>
                </div>
                <pre id="spec-pre">é»æ“Šã€Œç”¢ç”Ÿè¦æ ¼ã€æŒ‰éˆ•æŸ¥çœ‹çµæœ...</pre>
            </div>
            
            <!-- JSON -->
            <div id="json-output" class="output-content">
                <div class="action-buttons">
                    <button onclick="copyOutput('json')">ğŸ“‹ è¤‡è£½</button>
                </div>
                <pre id="json-pre">é»æ“Šã€Œç”¢ç”Ÿè¦æ ¼ã€æŒ‰éˆ•æŸ¥çœ‹çµæœ...</pre>
            </div>

            <!-- Gherkin -->
            <div id="gherkin-output" class="output-content">
                <div class="action-buttons">
                    <button onclick="copyOutput('gherkin')">ğŸ“‹ è¤‡è£½</button>
                </div>
                <pre id="gherkin-pre">é»æ“Šã€Œç”¢ç”Ÿè¦æ ¼ã€æŒ‰éˆ•æŸ¥çœ‹çµæœ...</pre>
            </div>
        </div>
    </div>
    
    <script>
        let structureHistory = [];
        let currentHistoryIndex = -1;
        
        // äº’å‹•åŠŸèƒ½è¿½è¹¤
        let currentSelectedLine = -1;
        let currentSelectedText = '';
        
        // çµ„ä»¶æ¨¡æ¿å®šç¾©
        const componentTemplates = {
            'Header': 'â”œâ”€ Header (å›ºå®šåœ¨é ‚éƒ¨)',
            'Toolbar': 'â”œâ”€ Toolbar (æ“ä½œå€)',
            'Sidebar': 'â”œâ”€ Sidebar (å´é‚Šæ¬„, width: 300px)',
            'Content': 'â”œâ”€ Content (ä¸»è¦å…§å®¹)',
            'Footer': 'â””â”€ Footer (é å°¾)',
            'Container': 'â”œâ”€ Container (max-width: 1200px)',
            'Grid': 'â”œâ”€ Grid Layout (columns: 3, gap: 16px)',
            'Flex': 'â”œâ”€ Flex Container (justify: space-between, align: center)',
            'Button': '  â”œâ”€ Button: "æŒ‰éˆ•æ–‡å­—" (primary)',
            'Input': '  â”œâ”€ Input Field (placeholder: "è«‹è¼¸å…¥...", type: text)',
            'Textarea': '  â”œâ”€ Textarea (placeholder: "è«‹è¼¸å…¥å…§å®¹...", rows: 4)',
            'Select': '  â”œâ”€ Select Dropdown (options: [é¸é …1, é¸é …2, é¸é …3])',
            'Checkbox': '  â”œâ”€ Checkbox: "åŒæ„æ¢æ¬¾"',
            'Radio': '  â”œâ”€ Radio Button Group: [é¸é …1, é¸é …2]',
            'Switch': '  â”œâ”€ Toggle Switch: "å•Ÿç”¨åŠŸèƒ½"',
            'Slider': '  â”œâ”€ Slider (min: 0, max: 100, value: 50)',
            'Navbar': 'â”œâ”€ Navigation Bar (items: [é¦–é , é—œæ–¼, è¯çµ¡])',
            'Menu': 'â”œâ”€ Menu (vertical)',
            'Tabs': 'â”œâ”€ Tabs (tabs: [æ¨™ç±¤1, æ¨™ç±¤2, æ¨™ç±¤3])',
            'Breadcrumb': 'â”œâ”€ Breadcrumb (path: é¦–é  > åˆ†é¡ > é é¢)',
            'Pagination': 'â”œâ”€ Pagination (total: 100, perPage: 20)',
            'Stepper': 'â”œâ”€ Stepper (steps: [æ­¥é©Ÿ1, æ­¥é©Ÿ2, æ­¥é©Ÿ3], current: 1)',
            'Table': '  â”œâ”€ Table (columns: [æ¬„ä½1, æ¬„ä½2, æ¬„ä½3])',
            'List': '  â”œâ”€ List (items: [é …ç›®1, é …ç›®2, é …ç›®3])',
            'Card': '  â”œâ”€ Card (title: "å¡ç‰‡æ¨™é¡Œ")',
            'Avatar': '  â”œâ”€ Avatar (size: 48px, src: "user.jpg")',
            'Badge': '  â”œâ”€ Badge: "æ–°" (color: primary)',
            'Chip': '  â”œâ”€ Chip: "æ¨™ç±¤" (closable: true)',
            'Tag': '  â”œâ”€ Tag: "åˆ†é¡" (color: blue)',
            'Timeline': 'â”œâ”€ Timeline (items: [äº‹ä»¶1, äº‹ä»¶2, äº‹ä»¶3])',
            'Alert': 'â”œâ”€ Alert: "æç¤ºè¨Šæ¯" (type: info)',
            'Toast': 'â”œâ”€ Toast: "æ“ä½œæˆåŠŸ" (type: success, duration: 3000ms)',
            'Modal': '  â”œâ”€ Modal Dialog (title: "æ¨™é¡Œ", width: 500px)',
            'Drawer': '  â”œâ”€ Drawer (position: right, width: 400px)',
            'Tooltip': '  â”œâ”€ Tooltip: "æç¤ºæ–‡å­—"',
            'Popover': '  â”œâ”€ Popover (trigger: click)',
            'Progress': '  â”œâ”€ Progress Bar (value: 60%, color: primary)',
            'Spinner': '  â”œâ”€ Loading Spinner (size: medium)',
            'Skeleton': '  â”œâ”€ Skeleton Loader (rows: 3)',
            'Dropdown': '  â”œâ”€ Dropdown Menu (items: [é¸é …1, é¸é …2])',
            'Accordion': 'â”œâ”€ Accordion (panels: [é¢æ¿1, é¢æ¿2])',
            'Carousel': 'â”œâ”€ Carousel (items: 3, autoplay: true)',
            'Divider': 'â”œâ”€ Divider (orientation: horizontal)',
            'Icon': '  â”œâ”€ Icon: "home" (size: 24px)',
            'Image': '  â”œâ”€ Image (src: "image.jpg", alt: "æè¿°")',
            'Video': '  â”œâ”€ Video Player (src: "video.mp4", controls: true)',
            'Form': 'â”œâ”€ Form (method: POST)'
        };
        
        // æ·»åŠ çµ„ä»¶
        function addComponent(type) {
            const structure = document.getElementById('structure');
            const line = componentTemplates[type] || `â”œâ”€ ${type}`;
            
            if (structure.value) {
                structure.value += '\n' + line;
            } else {
                structure.value = line;
            }
            
            updateStats();
            saveHistory();
        }
        
        // æ›´æ–°çµ±è¨ˆ
        function updateStats() {
            const structure = document.getElementById('structure').value;
            const lines = structure.split('\n').filter(l => l.trim());
            document.getElementById('line-count').textContent = `${lines.length} è¡Œ`;
            document.getElementById('component-count').textContent = `${lines.length} çµ„ä»¶`;
        }
        
        // ç›£è½æ–‡å­—æ¡†è®ŠåŒ–
        document.getElementById('structure').addEventListener('input', updateStats);
        
        // å„²å­˜æ­·å²è¨˜éŒ„
        function saveHistory() {
            const structure = document.getElementById('structure').value;
            structureHistory = structureHistory.slice(0, currentHistoryIndex + 1);
            structureHistory.push(structure);
            currentHistoryIndex++;
        }
        
        // å¾©åŸ
        function undo() {
            if (currentHistoryIndex > 0) {
                currentHistoryIndex--;
                document.getElementById('structure').value = structureHistory[currentHistoryIndex];
                updateStats();
            } else {
                alert('æ²’æœ‰å¯å¾©åŸçš„æ“ä½œäº†');
            }
        }
        
        // ===== äº’å‹•åŠŸèƒ½ç›¸é—œå‡½æ•¸ =====
        
        // ç›£è½çµæ§‹æ–‡å­—æ¡†çš„é¸æ“‡è®ŠåŒ–
        document.getElementById('structure').addEventListener('select', updateSelectionInfo);
        document.getElementById('structure').addEventListener('click', updateSelectionInfo);
        
        function updateSelectionInfo() {
            const textarea = document.getElementById('structure');
            const selectionInfo = document.getElementById('selectionInfo');
            
            // ç²å–æ¸¸æ¨™ä½ç½®
            const cursorPos = textarea.selectionStart;
            const text = textarea.value;
            
            // æ‰¾åˆ°ç•¶å‰è¡Œ
            const beforeCursor = text.substring(0, cursorPos);
            const currentLine = beforeCursor.split('\n').length;
            
            // ç²å–ç•¶å‰è¡Œçš„å…§å®¹
            const lines = text.split('\n');
            const lineText = lines[currentLine - 1] || '';
            
            if (lineText.trim()) {
                currentSelectedLine = currentLine - 1;
                currentSelectedText = lineText;
                selectionInfo.classList.remove('hidden');
                selectionInfo.innerHTML = `ğŸ“ å·²é¸æ“‡ç¬¬ ${currentLine} è¡Œ: <code>${lineText.substring(0, 40)}${lineText.length > 40 ? '...' : ''}</code>`;
            } else {
                currentSelectedLine = -1;
                currentSelectedText = '';
                selectionInfo.classList.add('hidden');
                selectionInfo.innerHTML = 'ğŸ“ æœªé¸æ“‡ä»»ä½•è¡Œ';
            }
        }
        
        // æ·»åŠ äº’å‹•åŠŸèƒ½
        function addInteraction(interactionType) {
            if (currentSelectedLine === -1) {
                alert('âš ï¸ è«‹å…ˆåœ¨å³å´çµæ§‹ä¸­é»æ“Šæˆ–é¸æ“‡è¦æ·»åŠ åŠŸèƒ½çš„è¡Œï¼');
                return;
            }
            
            const textarea = document.getElementById('structure');
            const lines = textarea.value.split('\n');
            let line = lines[currentSelectedLine];
            
            if (!line.trim()) {
                alert('âš ï¸ é¸ä¸­çš„è¡Œç‚ºç©ºï¼Œç„¡æ³•æ·»åŠ åŠŸèƒ½ï¼');
                return;
            }
            
            // æª¢æŸ¥æ˜¯å¦å·²ç¶“æœ‰æ‹¬è™Ÿ
            const hasParenthesis = line.includes('(');
            const functionName = `handle${interactionType.charAt(2).toUpperCase()}${interactionType.slice(3)}`;
            
            // æª¢æŸ¥æ˜¯å¦å·²ç¶“æœ‰æ­¤åŠŸèƒ½
            if (line.includes(interactionType)) {
                alert(`âš ï¸ æ­¤è¡Œå·²ç¶“æœ‰ ${interactionType} åŠŸèƒ½äº†ï¼`);
                return;
            }
            
            // æ·»åŠ åŠŸèƒ½æ¨™è¨˜
            if (hasParenthesis) {
                // å·²æœ‰æ‹¬è™Ÿï¼Œåœ¨æ‹¬è™Ÿå…§æ·»åŠ 
                line = line.replace(/\)(?!.*\))/g, `, ${interactionType}: ${functionName})`);
            } else {
                // æ²’æœ‰æ‹¬è™Ÿï¼Œæ·»åŠ æ–°æ‹¬è™Ÿ
                line = line.trimEnd() + ` (${interactionType}: ${functionName})`;
            }
            
            lines[currentSelectedLine] = line;
            textarea.value = lines.join('\n');
            
            // æ›´æ–°é¡¯ç¤ºå’Œä¿å­˜æ­·å²
            updateStats();
            saveHistory();
            updateSelectionInfo();
            
            // è¦–è¦ºåé¥‹
            highlightInteractionButton(interactionType);
            
            alert(`âœ… å·²æ·»åŠ  ${interactionType} åŠŸèƒ½åˆ°ç¬¬ ${currentSelectedLine + 1} è¡Œï¼`);
        }
        
        // ç§»é™¤ç•¶å‰è¡Œçš„æ‰€æœ‰äº’å‹•åŠŸèƒ½
        function removeInteractions() {
            if (currentSelectedLine === -1) {
                alert('âš ï¸ è«‹å…ˆåœ¨å³å´çµæ§‹ä¸­é»æ“Šæˆ–é¸æ“‡è¦ç§»é™¤åŠŸèƒ½çš„è¡Œï¼');
                return;
            }
            
            const textarea = document.getElementById('structure');
            const lines = textarea.value.split('\n');
            let line = lines[currentSelectedLine];
            
            // ç§»é™¤æ‰€æœ‰ on* åŠŸèƒ½æ¨™è¨˜
            line = line.replace(/,\s*(on\w+):\s*\w+/g, '');
            line = line.replace(/\((on\w+):\s*\w+\)/g, '');
            line = line.replace(/\((on\w+):\s*\w+,\s*/g, '(');
            
            // æ¸…ç†ç©ºæ‹¬è™Ÿ
            line = line.replace(/\(\s*\)/g, '');
            line = line.replace(/\(\s*,/g, '(');
            line = line.replace(/,\s*\)/g, ')');
            
            lines[currentSelectedLine] = line;
            textarea.value = lines.join('\n');
            
            updateStats();
            saveHistory();
            updateSelectionInfo();
            
            alert(`âœ… å·²ç§»é™¤ç¬¬ ${currentSelectedLine + 1} è¡Œçš„æ‰€æœ‰äº’å‹•åŠŸèƒ½ï¼`);
        }
        
        // é«˜äº®é¡¯ç¤ºç•¶å‰é¸æ“‡
        function highlightSelection() {
            if (currentSelectedLine === -1) {
                alert('âš ï¸ è«‹å…ˆåœ¨å³å´çµæ§‹ä¸­é»æ“Šæˆ–é¸æ“‡ä¸€è¡Œï¼');
                return;
            }
            
            const textarea = document.getElementById('structure');
            const lines = textarea.value.split('\n');
            
            // è¨ˆç®—é¸æ“‡ç¯„åœ
            let start = 0;
            for (let i = 0; i < currentSelectedLine; i++) {
                start += lines[i].length + 1; // +1 for newline
            }
            const end = start + lines[currentSelectedLine].length;
            
            // é¸ä¸­ä¸¦èšç„¦
            textarea.focus();
            textarea.setSelectionRange(start, end);
            
            // æ»¾å‹•åˆ°å¯è¦‹å€åŸŸ
            const lineHeight = 24; // ä¼°è¨ˆçš„è¡Œé«˜
            textarea.scrollTop = currentSelectedLine * lineHeight - textarea.clientHeight / 2;
        }
        
        // é«˜äº®äº’å‹•æŒ‰éˆ•ï¼ˆè¦–è¦ºåé¥‹ï¼‰
        function highlightInteractionButton(interactionType) {
            const buttons = document.querySelectorAll('.interaction-btn');
            buttons.forEach(btn => {
                if (btn.textContent.includes(interactionType)) {
                    btn.classList.add('selected');
                    setTimeout(() => {
                        btn.classList.remove('selected');
                    }, 500);
                }
            });
        }
        
        // ===== äº’å‹•åŠŸèƒ½ç›¸é—œå‡½æ•¸çµæŸ =====
        
        // ç”¢ç”Ÿè¦æ ¼
        function generateSpec() {
            const pageName = document.getElementById('pageName').value;
            const structure = document.getElementById('structure').value;
            
            if (!structure.trim()) {
                alert('è«‹å…ˆæ·»åŠ ä¸€äº›çµ„ä»¶ï¼');
                return;
            }
            
            // ç”¢ç”Ÿå„ç¨®æ ¼å¼
            generateVisual(pageName, structure);
            document.getElementById('ascii-pre').textContent = generateASCII(pageName, structure);
            document.getElementById('spec-pre').textContent = generateAISpec(pageName, structure);
            document.getElementById('json-pre').textContent = generateJSON(pageName, structure);
            document.getElementById('gherkin-pre').textContent = generateGherkin(pageName, structure);
            
            alert('âœ… è¦æ ¼å·²ç”¢ç”Ÿï¼åˆ‡æ›åˆ°å…¶ä»–æ¨™ç±¤æŸ¥çœ‹çµæœ');
        }

        // ç”¢ç”Ÿè¦–è¦ºåŒ– - ASCII ç‰ˆæœ¬ï¼ˆæ”¹é€²ç‰ˆï¼‰
        function generateVisual(pageName, structure) {
            const container = document.getElementById('visual-container');
            const lines = structure.split('\n').filter(l => l.trim());
            
            const width = 62;
            let output = [];
            
            // é ‚éƒ¨æ¨™é¡Œ
            output.push('â•”' + 'â•'.repeat(width) + 'â•—');
            output.push('â•‘' + center(`ğŸ“„ ${pageName}`, width) + 'â•‘');
            output.push('â• ' + 'â•'.repeat(width) + 'â•£');
            output.push('â•‘' + ' '.repeat(width) + 'â•‘');
            
            // ç”¨æ–¼è¿½è¹¤é€£çºŒçš„å°çµ„ä»¶
            let smallComponentBuffer = [];
            
            // è™•ç†æ¯ä¸€è¡Œ
            lines.forEach((line, index) => {
                const cleaned = line.replace(/[â”œâ”€â””â”‚]/g, '').trim();
                const indent = line.match(/^\s*/)[0].length;
                
                // æå–çµ„ä»¶åç¨±
                let componentName = cleaned;
                let annotation = '';
                let isSmallComponent = false;
                
                // æ ¹æ“šçµ„ä»¶é¡å‹æ·»åŠ è¨»è§£å’Œåˆ¤æ–·å¤§å°
                if (cleaned.includes('Header')) {
                    annotation = ' â† å›ºå®šé ‚éƒ¨';
                } else if (cleaned.includes('Timeline')) {
                    annotation = ' â† Timeline';
                } else if (cleaned.includes('Toolbar')) {
                    annotation = ' â† Toolbar';
                } else if (cleaned.includes('Navigation') || cleaned.includes('Navbar')) {
                    annotation = ' â† Navigation';
                } else if (cleaned.includes('Table')) {
                    const tableNum = (cleaned.match(/\d+/) || [])[0];
                    annotation = tableNum ? ` â† Table ${tableNum}` : ' â† Table';
                } else if (cleaned.includes('Grid')) {
                    annotation = ' â† Grid';
                } else if (cleaned.includes('Card')) {
                    annotation = ' â† å¡ç‰‡';
                } else if (cleaned.includes('Image') || cleaned.includes('åœ–ç‰‡')) {
                    annotation = ' â† Images';
                } else if (cleaned.includes('Sidebar')) {
                    annotation = ' â† å´é‚Šæ¬„';
                } else if (cleaned.includes('Content')) {
                    annotation = ' â† å…§å®¹å€';
                } else if (cleaned.includes('Footer')) {
                    annotation = ' â† é å°¾';
                } else if (cleaned.includes('Flex Container')) {
                    annotation = ' â† å½ˆæ€§ä½ˆå±€';
                } else if (cleaned.includes('Container')) {
                    annotation = ' â† å®¹å™¨';
                }
                
                // åˆ¤æ–·æ˜¯å¦ç‚ºå°å‹çµ„ä»¶ï¼ˆè¼¸å…¥é¡ã€é–‹é—œé¡ï¼‰
                if (cleaned.match(/^(Toggle|Checkbox|Radio|Switch|Button|Input|Tooltip|Badge|Chip|Icon|Avatar)[\s:]/i) ||
                    cleaned.match(/^(Drawer|Modal|Dialog|Snackbar|Alert)[\s:(]/i)) {
                    isSmallComponent = true;
                }
                
                // è™•ç†ç¸®æ’å’Œé¡¯ç¤º
                if (indent === 0) {
                    // å…ˆè¼¸å‡ºç·©å­˜çš„å°çµ„ä»¶
                    if (smallComponentBuffer.length > 0) {
                        smallComponentBuffer.forEach(comp => {
                            output.push('â•‘    â€¢ ' + comp.padEnd(width - 6) + 'â•‘');
                        });
                        smallComponentBuffer = [];
                        output.push('â•‘' + ' '.repeat(width) + 'â•‘');
                        output.push('â• ' + 'â•'.repeat(width) + 'â•£');
                    }
                    
                    // ä¸»è¦çµ„ä»¶
                    if (isSmallComponent) {
                        // å°çµ„ä»¶åŠ å…¥ç·©å­˜
                        smallComponentBuffer.push(componentName);
                    } else if (cleaned.includes('Table') || cleaned.includes('Timeline')) {
                        // å¸¶æ¡†çš„çµ„ä»¶
                        output.push('â•‘  â”Œ' + 'â”€'.repeat(width - 6) + 'â”  â•‘');
                        const contentLine = 'â•‘  â”‚  ' + componentName.padEnd(width - 10) + 'â”‚' + annotation.padEnd(0) + ' â•‘';
                        output.push(contentLine.substring(0, width + 2) + 'â•‘');
                        output.push('â•‘  â””' + 'â”€'.repeat(width - 6) + 'â”˜  â•‘');
                        output.push('â•‘' + ' '.repeat(width) + 'â•‘');
                        
                        if (index < lines.length - 1) {
                            output.push('â• ' + 'â•'.repeat(width) + 'â•£');
                        }
                    } else {
                        // æ™®é€šå¤§çµ„ä»¶
                        const displayText = componentName + annotation;
                        output.push('â•‘  ' + displayText.padEnd(width - 2) + 'â•‘');
                        output.push('â•‘' + ' '.repeat(width) + 'â•‘');
                        
                        if (index < lines.length - 1) {
                            output.push('â• ' + 'â•'.repeat(width) + 'â•£');
                        }
                    }
                } else {
                    // åµŒå¥—çµ„ä»¶
                    const indentStr = ' '.repeat(Math.min(indent * 2, 6));
                    const displayText = indentStr + 'â€¢ ' + componentName;
                    output.push('â•‘  ' + displayText.padEnd(width - 2) + 'â•‘');
                }
            });
            
            // è¼¸å‡ºå‰©é¤˜çš„å°çµ„ä»¶ç·©å­˜
            if (smallComponentBuffer.length > 0) {
                smallComponentBuffer.forEach(comp => {
                    output.push('â•‘    â€¢ ' + comp.padEnd(width - 6) + 'â•‘');
                });
                output.push('â•‘' + ' '.repeat(width) + 'â•‘');
            }
            
            // åº•éƒ¨
            output.push('â•š' + 'â•'.repeat(width) + 'â•');
            
            container.value = output.join('\n');
        }
        
        // å¾è¦–è¦ºåŒ–åŒæ­¥åˆ°çµæ§‹è¼¸å…¥
        function syncFromVisual() {
            const visualText = document.getElementById('visual-container').value;
            
            // è§£æ ASCII è¦–è¦ºåœ–
            const lines = visualText.split('\n');
            let structure = [];
            
            lines.forEach(line => {
                // æå–çµ„ä»¶åç¨±ï¼ˆåœ¨ â•‘ ä¹‹é–“çš„å…§å®¹ï¼‰
                const match = line.match(/â•‘\s*(.+?)\s*(?:â†.*)?â•‘/);
                if (match) {
                    let content = match[1].trim();
                    
                    // è·³éç©ºè¡Œã€åˆ†éš”ç·šã€æ¨™é¡Œç­‰
                    if (!content || content.includes('â•') || content.includes('â”€') || 
                        content.includes('â”Œ') || content.includes('â””') || 
                        content.includes('â”‚') || content.includes('ğŸ“„')) {
                        return;
                    }
                    
                    // æª¢æ¸¬ç¸®æ’
                    const indent = match[1].search(/\S/);
                    
                    // ç§»é™¤å‰å°ç¬¦è™Ÿ
                    content = content.replace(/^[â€¢\-\*]\s*/, '');
                    
                    // æ·»åŠ æ¨¹ç‹€ç¬¦è™Ÿ
                    if (indent > 2) {
                        structure.push('  ' + content);
                    } else {
                        structure.push('â”œâ”€ ' + content);
                    }
                }
            });
            
            if (structure.length > 0) {
                document.getElementById('structure').value = structure.join('\n');
                updateStats();
                saveHistory();
                alert('âœ… å·²åŒæ­¥åˆ°çµæ§‹è¼¸å…¥å€ï¼');
            } else {
                alert('âš ï¸ ç„¡æ³•å¾è¦–è¦ºåœ–ä¸­æå–çµæ§‹ï¼Œè«‹ç¢ºä¿æ ¼å¼æ­£ç¢ºã€‚');
            }
        }
        
        // åŒ¯å‡ºè¦–è¦ºåŒ– ASCII
        function exportVisualASCII() {
            const content = document.getElementById('visual-container').value;
            if (!content.trim()) {
                alert('âš ï¸ è¦–è¦ºåœ–ç‚ºç©ºï¼Œè«‹å…ˆç”Ÿæˆæˆ–ç·¨è¼¯å…§å®¹ï¼');
                return;
            }
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ui-visual-ascii.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('âœ… å·²åŒ¯å‡º ASCII è¦–è¦ºåœ–ï¼');
        }
        
        // é‡æ–°ç”Ÿæˆè¦–è¦ºåŒ–
        function refreshVisual() {
            const pageName = document.getElementById('pageName').value || 'æœªå‘½åé é¢';
            const structure = document.getElementById('structure').value;
            
            if (!structure.trim()) {
                alert('âš ï¸ è«‹å…ˆåœ¨å·¦å´è¼¸å…¥é é¢çµæ§‹ï¼');
                return;
            }
            
            generateVisual(pageName, structure);
            alert('âœ… å·²é‡æ–°ç”Ÿæˆè¦–è¦ºåœ–ï¼');
        }
        
        // ç½®ä¸­æ–‡å­—è¼”åŠ©å‡½æ•¸
        function center(text, width) {
            // è¨ˆç®—ä¸­æ–‡å­—ç¬¦ï¼ˆæ¯å€‹ä½”2å€‹ä½ç½®ï¼‰
            let displayWidth = 0;
            for (let char of text) {
                displayWidth += /[\u4e00-\u9fa5]/.test(char) ? 2 : 1;
            }
            
            const padding = Math.max(0, width - displayWidth);
            const left = Math.floor(padding / 2);
            const right = padding - left;
            return ' '.repeat(left) + text + ' '.repeat(right);
        }
        
        // ç”¢ç”Ÿ ASCII åœ–
        function generateASCII(pageName, structure) {
            const width = 70;
            let output = [];
            
            output.push('â”Œ' + 'â”€'.repeat(width - 2) + 'â”');
            output.push('â”‚' + center(`ğŸ“„ ${pageName}`, width - 2) + 'â”‚');
            output.push('â”œ' + 'â”€'.repeat(width - 2) + 'â”¤');
            
            const lines = structure.split('\n');
            lines.forEach(line => {
                if (line.trim()) {
                    const displayLine = line.length > width - 4 ? line.substring(0, width - 7) + '...' : line;
                    output.push('â”‚ ' + displayLine.padEnd(width - 3) + 'â”‚');
                }
            });
            
            output.push('â””' + 'â”€'.repeat(width - 2) + 'â”˜');
            
            return output.join('\n');
        }
        
        // ç”¢ç”Ÿ AI å¯è®€è¦æ ¼
        function generateAISpec(pageName, structure) {
            let spec = `é é¢ï¼š${pageName}\n\n`;
            spec += 'Layout (ä½ˆå±€)ï¼š\n';
            spec += structure;
            spec += '\n\nSpacing (é–“è·)ï¼š\n';
            spec += '- padding: 16px\n';
            spec += '- margin: 16px\n';
            spec += '- gutter: 8px\n';
            spec += '\nColor Palette (è‰²æ¿)ï¼š\n';
            spec += '- primary: #2563EB\n';
            spec += '- accent: #10B981\n';
            spec += '- error: #EF4444\n';
            spec += '\nInteractive States (äº’å‹•ç‹€æ…‹)ï¼š\n';
            spec += '- Hover: èƒŒæ™¯è®Šæ·± 5%\n';
            spec += '- Active: ç¸®æ”¾ 0.98x\n';
            spec += '- Focus: è—è‰² outline 2px\n';
            
            return spec;
        }
        
        // ç”¢ç”Ÿ JSON
        function generateJSON(pageName, structure) {
            const lines = structure.split('\n').filter(l => l.trim());
            const components = lines.map(line => {
                const cleaned = line.replace(/[â”œâ”€â””â”‚]/g, '').trim();
                return { component: cleaned };
            });
            
            return JSON.stringify({
                pageName: pageName,
                version: "2.0",
                components: components,
                theme: {
                    colors: {
                        primary: "#2563EB",
                        accent: "#10B981",
                        error: "#EF4444"
                    },
                    spacing: {
                        padding: "16px",
                        margin: "16px",
                        gutter: "8px"
                    }
                }
            }, null, 2);
        }
        
        // ç”¢ç”Ÿ Gherkin
        function generateGherkin(pageName, structure) {
            let gherkin = `Feature: ${pageName}\n`;
            gherkin += `  ä½œç‚ºç³»çµ±ä½¿ç”¨è€…\n`;
            gherkin += `  æˆ‘æƒ³è¦ä½¿ç”¨${pageName}\n`;
            gherkin += `  ä»¥ä¾¿å®Œæˆæˆ‘çš„å·¥ä½œ\n\n`;
            gherkin += `  Background:\n`;
            gherkin += `    Given æˆ‘å·²ç¶“é–‹å•Ÿ"${pageName}"\n\n`;
            gherkin += `  Scenario: æŸ¥çœ‹é é¢çµæ§‹\n`;
            
            const lines = structure.split('\n').filter(l => l.trim());
            lines.forEach(line => {
                const cleaned = line.replace(/[â”œâ”€â””â”‚]/g, '').trim();
                gherkin += `    Then æˆ‘æ‡‰è©²çœ‹åˆ° ${cleaned}\n`;
            });
            
            return gherkin;
        }
        
        // åˆ‡æ›æ¨™ç±¤
        function switchTab(tab) {
            document.querySelectorAll('.output-tabs button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.output-content').forEach(content => {
                content.classList.remove('active');
            });
            
            event.target.classList.add('active');
            document.getElementById(tab + '-output').classList.add('active');
        }
        
        // è¤‡è£½è¼¸å‡º
        function copyOutput(type) {
            let textToCopy = '';
            
            if (type === 'visual') {
                // è¤‡è£½è¦–è¦ºåŒ–çš„ ASCII æ–‡å­—ï¼ˆå¾ textareaï¼‰
                const container = document.getElementById('visual-container');
                textToCopy = container.value;
            } else {
                const pre = document.getElementById(type + '-pre');
                textToCopy = pre.textContent;
            }
            
            if (!textToCopy.trim()) {
                alert('âš ï¸ å…§å®¹ç‚ºç©ºï¼Œç„¡æ³•è¤‡è£½ï¼');
                return;
            }
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'âœ“ å·²è¤‡è£½';
                btn.classList.add('copy-success');
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.classList.remove('copy-success');
                }, 2000);
            });
        }
        
        // æ¸…ç©º
        function clearAll() {
            if (confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰å…§å®¹å—ï¼Ÿ')) {
                document.getElementById('structure').value = '';
                updateStats();
                saveHistory();
            }
        }
        
        // è¼‰å…¥ç¯„ä¾‹ (èˆ‡ä¹‹å‰ç›¸åŒï¼Œç•¥)
        function loadExample(type) {
            const examples = {
                'login': {
                    name: 'ç™»å…¥é é¢',
                    structure: `â”œâ”€ Container (max-width: 400px)
â”œâ”€ Card
  â”œâ”€ Icon: "logo" (size: 64px)
  â”œâ”€ Form
    â”œâ”€ Input Field (placeholder: "Email")
    â”œâ”€ Input Field (placeholder: "å¯†ç¢¼")
    â”œâ”€ Button: "ç™»å…¥" (primary)`
                },
                'dashboard': {
                    name: 'å„€è¡¨æ¿',
                    structure: `â”œâ”€ Header (å›ºå®šåœ¨é ‚éƒ¨)
â”œâ”€ Sidebar (å´é‚Šæ¬„, width: 240px)
â”œâ”€ Content (ä¸»è¦å…§å®¹)
  â”œâ”€ Grid Layout (columns: 3)
    â”œâ”€ Card (çµ±è¨ˆå¡ç‰‡)
    â”œâ”€ Card (çµ±è¨ˆå¡ç‰‡)
    â”œâ”€ Card (çµ±è¨ˆå¡ç‰‡)`
                },
                'form': {
                    name: 'è¡¨å–®é é¢',
                    structure: `â”œâ”€ Header
â”œâ”€ Container (max-width: 600px)
  â”œâ”€ Form
    â”œâ”€ Input Field (label: "å§“å")
    â”œâ”€ Input Field (label: "Email")
    â”œâ”€ Button: "æäº¤" (primary)`
                },
                'ecommerce': {
                    name: 'é›»å•†é é¢',
                    structure: `â”œâ”€ Header (å›ºå®šåœ¨é ‚éƒ¨)
â”œâ”€ Navigation Bar (items: [é¦–é , å•†å“, é—œæ–¼])
â”œâ”€ Grid Layout (columns: 4)
  â”œâ”€ Card (ç”¢å“å¡ç‰‡)
  â”œâ”€ Card (ç”¢å“å¡ç‰‡)
  â”œâ”€ Card (ç”¢å“å¡ç‰‡)`
                },
                'admin': {
                    name: 'å¾Œå°ç³»çµ±',
                    structure: `â”œâ”€ Header (å›ºå®šåœ¨é ‚éƒ¨)
â”œâ”€ Sidebar (å´é‚Šæ¬„, width: 260px)
â”œâ”€ Content
  â”œâ”€ Toolbar (æ“ä½œå€)
  â”œâ”€ Table (columns: [ç·¨è™Ÿ, ç”¨æˆ¶, ç‹€æ…‹])
  â”œâ”€ Pagination`
                }
            };
            
            const example = examples[type];
            if (example) {
                document.getElementById('pageName').value = example.name;
                document.getElementById('structure').value = example.structure;
                updateStats();
                saveHistory();
            }
        }
        
        // åˆå§‹åŒ–
        saveHistory();
        updateStats();
    </script>
</body>
</html>
